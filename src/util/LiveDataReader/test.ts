import liveDataReader from ".";
import ModelFeatureCollection, {
  ModelLiveData
} from "../../interfaces/ModelFeatureCollection";

const fs = require("fs");
const inModel = fs.readFileSync(__dirname + "/testData/in.json", "utf8");

const output: ModelLiveData = {
  liveDataPoints: [
    {
      nodeId: "4003P01",
      liveDataId: "4003P01",
      epanetId: 19
    }
  ],
  sensorData: {
    "4003P01": [
      13.432096747970329,
      13.414046080906129,
      13.428362127198428,
      13.361138953304028,
      13.477534634028528,
      13.403464655385628,
      13.403464655385628,
      13.392883229865229,
      13.392883229865229,
      13.428362127198428,
      13.389771045888729,
      13.36487357407593,
      13.42151532244993,
      13.410933896929528,
      13.424627506426528,
      13.403464655385628,
      13.400352471409128,
      13.36487357407593,
      13.354292148555528,
      13.36487357407593,
      13.432096747970329,
      13.283956790684629,
      13.245365709374928,
      13.192458581772929,
      13.167561109960229,
      13.111541798381628,
      12.99141149688523,
      12.811527263038329,
      12.967136461867828,
      12.808415079061728,
      12.614214798922628,
      12.431218381099129,
      12.66027512177613,
      12.794099032769429,
      12.893066483225029,
      13.012574347926028,
      12.995146117657129,
      13.122123223902028,
      12.952820415575529,
      12.984564692136729,
      13.09037894734083,
      12.99141149688523,
      13.114653982358128,
      13.135816833399028,
      13.08290970579693,
      13.048053245259128,
      13.08290970579693,
      13.164448925983628,
      13.174407914708729,
      13.08290970579693,
      13.037471819738728,
      13.086644326568829,
      13.227315042310728,
      13.114653982358128,
      13.241631088603029,
      13.107807177609729,
      13.22420285833413,
      13.195570765749528,
      13.262793939643828,
      13.216733616790329,
      13.132704649422429,
      13.13955145417093,
      13.216733616790329,
      13.086644326568829,
      13.18187715625253,
      13.146398258919428,
      13.178142535480628,
      13.107807177609729,
      13.097225752089228,
      13.09037894734083,
      13.030002578194928,
      13.111541798381628,
      13.001992922405629,
      12.921076139014328,
      12.885597241681229,
      12.871903632184228,
      12.688284777565428,
      12.811527263038329,
      12.998258301633728,
      12.734345100418928,
      12.949085794803628,
      13.054900050007628,
      12.99141149688523,
      12.984564692136729,
      13.203040007293328,
      13.125235407878629,
      13.001992922405629,
      13.026890394218329,
      13.08290970579693,
      13.069216096299929,
      13.051165429235729,
      13.051165429235729,
      13.262793939643828,
      13.203040007293328,
      13.308854262497329,
      13.31570106724583
    ]
  }
};

it("returns live data from model file", () => {
  const modelJson = JSON.parse(inModel);
  expect(liveDataReader(modelJson, 96)).toEqual(output);
});
